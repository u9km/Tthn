      - name: Dynamic Tools Installation (Smart Search)
        env:
          GH_TOKEN: ${{ github.token }}
        run: |
          sudo apt-get update
          
          # تحميل أحدث إصدار من LSPatch مهما كان اسمه
          # سنبحث عن أول ملف ينتهي بـ .jar ونقوم بتسميته lspatch.jar
          gh release download --repo LSPosed/LSPatch --pattern "*.jar"
          mv *.jar lspatch.jar || echo "Already named correctly"
          
          # تحميل Uber APK Signer بنفس الطريقة الذكية
          gh release download --repo patrickfav/uber-apk-signer --pattern "*.jar"
          # إعادة تسمية الملف ليكون موحداً للسكربت
          find . -name "uber-apk-signer*.jar" -exec mv {} uber-apk-signer.jar \;

      - name: Pro Verification
        run: |
          # فحص إذا تم التحميل بنجاح
          if [ ! -f lspatch.jar ]; then
             echo "❌ فشل تحميل LSPatch! جاري التحميل برابط مباشر احتياطي..."
             curl -L -o lspatch.jar https://github.com/LSPosed/LSPatch/releases/download/v0.6/lspatch.jar
          fi
