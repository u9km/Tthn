name: Pro APK Hook Injector
on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Setup Java
        uses: actions/setup-java@v3
        with:
          java-version: '11'
          distribution: 'temurin'

      - name: Download Tools (LSPatch & Uber APK Signer)
        run: |
          wget https://github.com/LSPosed/LSPatch/releases/latest/download/lspatch.jar
          wget https://github.com/patrickfav/uber-apk-signer/releases/latest/download/uber-apk-signer.jar

      - name: Patch APK with Hook
        run: |
          # نضع هنا رابط APK النسخة الأصلية 1.0.26
          wget -O original.apk "رابط_تحميل_النسخة_الأصلية"
          
          # عملية الحقن: دمج أداة الهوك داخل التطبيق
          java -jar lspatch.jar original.apk -m ./hook_module.apk --manager -v

      - name: Sign Patched APK
        run: |
          java -jar uber-apk-signer.apk --apks .
          
      - name: Upload Pro Result
        uses: actions/upload-artifact@v3
        with:
          name: Patched-Pro-DarkTunnel
          path: ./*-aligned-debugSigned.apk
